<div class="d-flex align-items-stretch wrap-container">
  <div class="card align-self-center bg-dark text-light rounded-lg left-bar">
    <button routerLink="../profile" class="bi bi-person btn btn-dark icons icon-first"></button>
    <button routerLink="../group" class="bi bi-people btn btn-dark icons icon-middle"></button>
    <button class="bi bi-house-door-fill btn btn-dark icons icon-middle"></button>
    <button
      routerLink="../direct"
      class="bi bi-chat-square-dots btn btn-dark icons icon-middle"
    ></button>
    <button routerLink="../search" class="bi bi-search btn btn-dark icons icon-last"></button>
  </div>
  <div
    class="d-flex flex-column card flex-grow-1 bg-dark text-light rounded-lg mx-auto main-container"
    #chatBox
  >
    <div *ngIf="(chat$ | async).length != 0" class="chat-container">
      <div *ngFor="let date of chat$ | async">
        <div class="d-flex justify-content-center align-items-center badge-wrap">
          <span class="badge badge-pill badge-secondary message-date-badge">
            {{ date.date }}
          </span>
        </div>
        <div *ngFor="let message of date.messages" #message [id]="message.id">
          <app-message-container
            [message]="message"
            (scroll)="scrollToElement($event)"
            (edit)="configInfo('edit', $event)"
            (reply)="configInfo('reply', { id: $event })"
            (delete)="deleteMessage($event)"
            [editInfoAccessibility]="message.composerId == (user$ | async).id"
          ></app-message-container>
        </div>
      </div>
    </div>

    <div *ngIf="(chat$ | async).length == 0" class="empty-chat">
      <span class="badge badge-secondary badge-pill custom-empty-badge">No messages yet ...</span>
    </div>

    <div class="bg-dark fixed-bottom message-input-container">
      <button
        *ngIf="submitMode == 'reply'"
        class="d-flex justify-content-center align-items-center bg-transparent text-light top-reply-badge"
        (click)="scrollToElement(data.replyId)"
      >
        <button class="bg-transparent custom-close-icon" (click)="submitMode = 'send'">
          <i class="bi bi-x-circle text-danger"></i>
        </button>
        Reply to {{ data.replyToName }}
      </button>
      <div class="d-flex justify-content-center align-items-center">
        <input
          [formControl]="messageForm"
          type="text"
          placeholder="Type your message"
          class="flex-grow-1 form-control bg-dark text-light mr-2 rounded-lg"
        />
        <button (click)="onSubmitMessage()" class="btn btn-danger rounded-lg text-light">
          Send
        </button>
      </div>
    </div>
  </div>
</div>
